@model HarmonicPatternsBase.Models.StatisticsViewModels.StatisticsIndexViewModel

@{
    ViewData["Title"] = "Baza układów harmonicznych";
}


<div style="background-color:#36424a">
    <div class="container" style="padding:20px;">

        <div class="dropdown" style="display:inline-block;">
            <button class="btn button-purple dropdown-toggle button-nav" type="button" id="dropdownMenu"
                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">

                @if (Model.SelectedInstrument == null)
                {
                    <span>Instrument</span>
                }
                else
                {
                    @Model.SelectedInstrument.Name
                }

                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenu">

                <li>
                    <a asp-action="Index"
                       asp-route-userid="@Model.SelectedUserId"
                       asp-route-datesince="@Model.DateSince"
                       asp-route-dateto="@Model.DateTo"
                       asp-route-adddatesince="@Model.AddDateSince"
                       asp-route-adddateto="@Model.AddDateTo"
                       asp-route-intervalid="@Model.SelectedIntervalId"
                       asp-route-patterntypeid="@Model.SelectedPatternId"
                       asp-route-patterndirectid="@Model.SelectedDirectId"
                       asp-route-instrumentid="@null">
                        Wszystkie instrumenty
                    </a>
                </li>

                <li class="divider"></li>

                @{foreach (var category in Model.InstrumentsCategories)
                    {
                        <li class="menu-item dropdown dropdown-submenu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">@category.Name</a>
                            <ul class="dropdown-menu">
                                @foreach (var item in category.Instruments)
                                {
                                    <li>
                                        <a asp-action="Index"
                                           asp-route-userid="@Model.SelectedUserId"
                                           asp-route-datesince="@Model.DateSince"
                                           asp-route-dateto="@Model.DateTo"
                                           asp-route-adddatesince="@Model.AddDateSince"
                                           asp-route-adddateto="@Model.AddDateTo"
                                           asp-route-intervalid="@Model.SelectedIntervalId"
                                           asp-route-patterntypeid="@Model.SelectedPatternId"
                                           asp-route-patterndirectid="@Model.SelectedDirectId"
                                           asp-route-instrumentid="@item.Id">
                                            @item.Name
                                        </a>
                                    </li>
                                }
                            </ul>
                        </li>
                    }
                }
            </ul>
        </div>


        <div class="dropdown" style="display:inline-block;">
            <button class="btn button-blue dropdown-toggle button-nav" type="button" id="dropdownMenu"
                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">

                @if (Model.SelectedPattern == null)
                {
                    <span>Uklad</span>
                }
                else
                {
                    @Model.SelectedPattern.Name
                }

                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenu">

                <li>
                    <a asp-action="Index"
                       asp-route-userid="@Model.SelectedUserId"
                       asp-route-datesince="@Model.DateSince"
                       asp-route-dateto="@Model.DateTo"
                       asp-route-adddatesince="@Model.AddDateSince"
                       asp-route-adddateto="@Model.AddDateTo"
                       asp-route-intervalid="@Model.SelectedIntervalId"
                       asp-route-instrumentid="@Model.SelectedInstrumentId"
                       asp-route-patterndirectid="@Model.SelectedDirectId"
                       asp-route-patterntypeid="@null">
                        Wszystkie uklady
                    </a>
                </li>

                <li class="divider"></li>

                @foreach (var item in Model.PatternTypes)
                {
                    <li>
                        <a asp-action="Index"
                           asp-route-userid="@Model.SelectedUserId"
                           asp-route-datesince="@Model.DateSince"
                           asp-route-dateto="@Model.DateTo"
                           asp-route-adddatesince="@Model.AddDateSince"
                           asp-route-adddateto="@Model.AddDateTo"
                           asp-route-intervalid="@Model.SelectedIntervalId"
                           asp-route-instrumentid="@Model.SelectedInstrumentId"
                           asp-route-patterndirectid="@Model.SelectedDirectId"
                           asp-route-patterntypeid="@item.Id">
                            @item.Name
                        </a>
                    </li>
                }
            </ul>
        </div>

        <div class="dropdown" style="display:inline-block;">
            <button class="btn button-green dropdown-toggle button-nav" type="button" id="dropdownMenu"
                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">

                @if (Model.SelectedInterval == null)
                {
                    <span>Interwal</span>
                }
                else
                {
                    @Model.SelectedInterval.Name
                }

                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenu">

                <li>
                    <a asp-action="Index"
                       asp-route-userid="@Model.SelectedUserId"
                       asp-route-datesince="@Model.DateSince"
                       asp-route-dateto="@Model.DateTo"
                       asp-route-adddatesince="@Model.AddDateSince"
                       asp-route-adddateto="@Model.AddDateTo"
                       asp-route-patterntypeid="@Model.SelectedPatternId"
                       asp-route-instrumentid="@Model.SelectedInstrumentId"
                       asp-route-patterndirectid="@Model.SelectedDirectId"
                       asp-route-intervalid="@null">
                        Wszystkie interwaly
                    </a>
                </li>

                <li class="divider"></li>

                @foreach (var item in Model.Intervals)
                {
                    <li>
                        <a asp-action="Index"
                           asp-route-userid="@Model.SelectedUserId"
                           asp-route-datesince="@Model.DateSince"
                           asp-route-dateto="@Model.DateTo"
                           asp-route-adddatesince="@Model.AddDateSince"
                           asp-route-adddateto="@Model.AddDateTo"
                           asp-route-patterntypeid="@Model.SelectedPatternId"
                           asp-route-instrumentid="@Model.SelectedInstrumentId"
                           asp-route-patterndirectid="@Model.SelectedDirectId"
                           asp-route-intervalid="@item.Id">
                            @item.Name
                        </a>
                    </li>
                }
            </ul>
        </div>

        <div class="dropdown" style="display:inline-block;">
            <button class="btn button-pink dropdown-toggle button-nav" type="button" id="dropdownMenu"
                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">

                @if (Model.SelectedDirect == null)
                {
                    <span>Kierunek</span>
                }
                else
                {
                    @Model.SelectedDirect.Name
                }

                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenu">

                <li>
                    <a asp-action="Index"
                       asp-route-userid="@Model.SelectedUserId"
                       asp-route-datesince="@Model.DateSince"
                       asp-route-dateto="@Model.DateTo"
                       asp-route-adddatesince="@Model.AddDateSince"
                       asp-route-adddateto="@Model.AddDateTo"
                       asp-route-intervalid="@Model.SelectedIntervalId"
                       asp-route-patterntypeid="@Model.SelectedPatternId"
                       asp-route-instrumentid="@Model.SelectedInstrumentId"
                       asp-route-patterndirectid="@null">
                        Wszystkie kierunki
                    </a>
                </li>

                <li class="divider"></li>

                @foreach (var item in Model.PatternDirects)
                {
                    <li>
                        <a asp-action="Index"
                           asp-route-userid="@Model.SelectedUserId"
                           asp-route-datesince="@Model.DateSince"
                           asp-route-dateto="@Model.DateTo"
                           asp-route-adddatesince="@Model.AddDateSince"
                           asp-route-adddateto="@Model.AddDateTo"
                           asp-route-intervalid="@Model.SelectedIntervalId"
                           asp-route-patterntypeid="@Model.SelectedPatternId"
                           asp-route-instrumentid="@Model.SelectedInstrumentId"
                           asp-route-patterndirectid="@item.Id">
                            @item.Name
                        </a>
                    </li>
                }
            </ul>
        </div>

        <div class="navbar-right" style="display:inline-block;">
            <a asp-area="" asp-controller="HarmonicPatterns" asp-action="Create" class="btn button-navframe">Dodaj</a>
        </div>

    </div>
</div>

<div style="padding-top:30px; padding-bottom:5px; background-color:#c1d0d3" id="advencedOptions" hidden>

    <div class="container">

        <form asp-controller="HarmonicPatterns"
              asp-action="index"
              asp-route-userid="@Model.SelectedUserId"
              asp-route-intervalid="@Model.SelectedIntervalId"
              asp-route-patterntypeid="@Model.SelectedPatternId"
              asp-route-instrumentid="@Model.SelectedInstrumentId"
              asp-route-patterndirectid="@Model.SelectedDirectId" method="get">

            <div class="row">
                <div class="row">
                    <div class="col-md-3">
                        <div class="text" style="font-size:18px;">
                            Data wystapienia na rynku:
                        </div>
                    </div>
                    <div class="col-md-8">
                        <div>
                            <input type="date" class="form-control" style="display:inline-block;" name="dateSince" value="@Model.DateSinceString">
                            -
                            <input type="date" class="form-control" style="display:inline-block;" name="dateTo" value="@Model.DateToString">
                        </div>
                    </div>
                </div>
                <div class="row" style="margin-top:10px;">
                    <div class="col-md-3">
                        <div class="text" style="font-size:18px;">
                            Data dodania do bazy:
                        </div>
                    </div>
                    <div class="col-md-8">
                        <div>
                            <input type="date" class="form-control" style="display:inline-block;" name="addDateSince" value="@Model.AddDateSinceString">
                            -
                            <input type="date" class="form-control" style="display:inline-block;" name="addDateTo" value="@Model.AddDateToString">
                        </div>
                    </div>
                </div>
            </div>

            <div style="text-align:center; margin-top:30px; margin-bottom:10px;">
                <input type="submit" class="btn btn button-blueframe" style="background-color:#c1d0d3; padding: 8px 25px; font-weight:bold" value="Szukaj ukladow">
            </div>

        </form>
    </div>

</div>

<div style="background-color:#c1d0d3; padding:0px; color:#167aa3; text-align:center">
    <button id="advencedOptionsTriggerUp" class="btn button-chevron" style="display: none;">
        <span class="glyphicon glyphicon-chevron-up"></span>
    </button>
    <button id="advencedOptionsTriggerDown" class="btn button-chevron">
        <span class="glyphicon glyphicon-chevron-down"></span>
    </button>
</div>

<div style="padding:30px; background-color:#d6d9dc">

    <div class="text container">

        <div class="text-blue" style="font-size:15px">
            <span style="color:#920063"><strong> @Model.Statistics.Count </strong></span>
            ukladow
            @if (Model.SelectedInstrumentId != null)
            {
                <span><a asp-action="Edit" class="btn button-purple"> @Model.SelectedInstrument.Name</a></span>
            }
            @if (Model.SelectedPatternId != null)
            {
                <a asp-controller="Patterns" asp-action="Details" asp-route-id="@Model.SelectedPattern.Id" class="btn button-blue">@Model.SelectedPattern.Name</a>
            }
            @if (Model.SelectedIntervalId != null)
            {
                <a asp-action="Edit" class="btn button-green">@Model.SelectedInterval.Name</a>
            }
            @if (Model.SelectedDirectId != null)
            {
                <a asp-action="Edit" class="btn button-pink">@Model.SelectedDirect.Name</a>
            }
            @if (Model.SelectedUser != null)
            {
                <span>dodanych przez</span>
                        <div class="userHolder-rounded">
                            @if (Model.SelectedUser.Avatar.Length > 5)
                            {
                                var base64 = Convert.ToBase64String(Model.SelectedUser.Avatar);
                                var userImageContent = String.Format("data:image/gif;base64,{0}", base64);
                                <img src='@userImageContent' class="img-circle" style="height:40px; width:40px; display:inline-block;" />
                                <a asp-action="Index" asp-controller="User" asp-route-userid="@Model.SelectedUserId" class="text text-blue" style="margin-left:5px; margin-right:10px; display:inline-block; font-size:12px;">@Model.SelectedUser.Nick.ToUpper()</a>
                            }
                        </div>
            }

            w bazie danych

            @if (Model.SelectedInstrumentId != null ||
                        Model.SelectedPatternId != null ||
                        Model.SelectedIntervalId != null ||
                        Model.SelectedDirectId != null ||
                        Model.SelectedUser != null)
            {
                <a asp-controller="HarmonicPatterns"
                   asp-action="Index"
                   class="btn button-blueframe"
                   style="margin-left:10px;">
                    usun filtry
                </a>
            }


        </div>

        <div class="row" style="margin-top:30px;">

            <div class="col-md-4">
                <div style="margin-bottom:15px;">
                    POZIOM REAKCJI OSIAGNIETE PO 5 SWIECACH
                </div>
                @foreach (var item in Model.Statistics.ReactionAfter5Candles)
                {
                    <div class="row" style="margin-bottom:5px;">
                        <div class="col-md-2">
                            <span style="color:#920063;"><strong>@item.PercentOfAllData.ToString("#")%</strong> </span>
                        </div>
                        <div class="col-md-7">
                            ukladow osiagnelo poziom
                        </div>
                        <div class="col-md-2" style="text-align:center">
                            <a asp-controller="Info" asp-action="Reactions" style="color:#920063">@Model.ReactionLevels.Find(h => h.Id == item.ReactionId).Name</a>
                        </div>
                    </div>
                }
            </div>
            <div class="col-md-4">
                <div style="margin-bottom:15px;">
                    POZIOM REAKCJI OSIAGNIETE PO 10 SWIECACH
                </div>
                @foreach (var item in Model.Statistics.ReactionAfter10Candles)
                {
                    <div class="row" style="margin-bottom:5px;">
                        <div class="col-md-2">
                            <span style="color:#920063;"><strong>@item.PercentOfAllData.ToString("#")%</strong> </span>
                        </div>
                        <div class="col-md-7">
                            ukladow osiagnelo poziom
                        </div>
                        <div class="col-md-2" style="text-align:center">
                            <a asp-controller="Info" asp-action="Reactions" style="color:#920063">@Model.ReactionLevels.Find(h => h.Id == item.ReactionId).Name</a>
                        </div>
                    </div>
                }
            </div>
            <div class="col-md-4">
                <div style="margin-bottom:15px;">
                    POZIOM REAKCJI OSIAGNIETE PO 20 SWIECACH
                </div>
                @foreach (var item in Model.Statistics.ReactionAfter20Candles)
                {
                    <div class="row" style="margin-bottom:5px;">
                        <div class="col-md-2">
                            <span style="color:#920063;"><strong>@item.PercentOfAllData.ToString("#")%</strong> </span>
                        </div>
                        <div class="col-md-7">
                            ukladow osiagnelo poziom
                        </div>
                        <div class="col-md-2" style="text-align:center">
                            <a asp-controller="Info" asp-action="Reactions" style="color:#920063">@Model.ReactionLevels.Find(h => h.Id == item.ReactionId).Name</a>
                        </div>
                    </div>
                }
            </div>
        </div>


        <div style="margin-top:40px;">
            <a asp-controller="HarmonicPatterns"
               asp-action="Index"
               asp-route-intervalid="@Model.SelectedIntervalId"
               asp-route-patterntypeid="@Model.SelectedPatternId"
               asp-route-instrumentid="@Model.SelectedInstrumentId"
               asp-route-patterndirectid="@Model.SelectedDirectId"
               class="btn button-blueframe">
                Pokaz uklady harmoniczne
            </a>
            <a asp-controller="Info" asp-action="Patterns" class="btn button-blueframe" style="margin-left:10px;">O ukladach harmonicznych</a>
            <a asp-controller="Info" asp-action="Reactions" class="btn button-blueframe" style="margin-left:10px;">O poziomach reakcji</a>
        </div>



    </div>
</div>


<div class="container" style="margin-top:10px">


    <div class="row">
        <div class="row admin-panel">
            <h3 class="admin-panel-text">W budowie ;)</h3>
            <h5 class="admin-panel-text">Wykresy, analizy danych</h5>
            <h5 class="admin-panel-text">Jaki procent ukladow po osiagnieciu poziomu B osiąga poziom C i A?</h5>
            <h5 class="admin-panel-text">Jakie uklady szybciej osiagaja poziom B C A?</h5>
            <h5 class="admin-panel-text">W jakich godzinach i na jakich interwalach pojawia sie najwiecej ukladow?</h5>
            <h5 class="admin-panel-text">W ktorych godzinach uklady sie najlepiej realizują?</h5>
            <h5 class="admin-panel-text">itd...</h5>
        </div>
    </div>

    <row>
        <h3>ANALIZA REAKCJI</h3>
        <h4 style="margin-bottom:30px;">ile ukladow osiagajacych dany poziom reakcji po 5 swiecach osiaga dany poziom reakcji po 10 swiecach</h4>

        @{
            foreach (var reaction5to10 in Model.Statistics.ReactionFrom5candlesTo10candles)
            {
                <div class="row" style="margin-bottom:5px;">
                    <div class="col-md-1">
                        <span style="color:#920063;"><strong>@reaction5to10.Percent.ToString("#")%</strong> </span>
                    </div>
                    <div class="col-md-3">
                        ukladow osiagajacych poziom 
                    </div>
                    <div class="col-md-1" style="text-align:center">
                        <a asp-controller="Info" asp-action="Reactions" style="color:#920063">@Model.ReactionLevels.Find(h => h.Id == reaction5to10.FirstReactionId).Name</a>
                    </div>
                    <div class="col-md-2">
                        osiaga poziom
                    </div>
                    <div class="col-md-1" style="text-align:center">
                        <a asp-controller="Info" asp-action="Reactions" style="color:#920063">@Model.ReactionLevels.Find(h => h.Id == reaction5to10.SecondReactionId).Name</a>
                    </div>

                </div>
            }
        }

        <h4 style="margin-bottom:30px; margin-top:40px;">ile ukladow osiagajacych dany poziom reakcji po 5 swiecach osiaga dany poziom reakcji po 20 swiecach</h4>

        @{
            foreach (var reaction5to20 in Model.Statistics.ReactionFrom5candlesTo20candles)
            {
                <div class="row" style="margin-bottom:5px;">
                    <div class="col-md-1">
                        <span style="color:#920063;"><strong>@reaction5to20.Percent.ToString("#")%</strong> </span>
                    </div>
                    <div class="col-md-3">
                        ukladow osiagajacych poziom
                    </div>
                    <div class="col-md-1" style="text-align:center">
                        <a asp-controller="Info" asp-action="Reactions" style="color:#920063">@Model.ReactionLevels.Find(h => h.Id == reaction5to20.FirstReactionId).Name</a>
                    </div>
                    <div class="col-md-2">
                        osiaga poziom
                    </div>
                    <div class="col-md-1" style="text-align:center">
                        <a asp-controller="Info" asp-action="Reactions" style="color:#920063">@Model.ReactionLevels.Find(h => h.Id == reaction5to20.SecondReactionId).Name</a>
                    </div>

                </div>
            }
        }
    </row>

</div>
